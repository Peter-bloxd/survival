<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生存法则 - 官方社区</title>
    <style>
        :root { --main-green: #2ecc71; --card-bg: #161b22; --text-gray: #8b949e; }
        body { background-color: #0d1117; color: white; font-family: 'Segoe UI', sans-serif; margin: 0; text-align: center; }
        nav { display: flex; justify-content: space-between; padding: 15px 50px; align-items: center; background: #161b22; border-bottom: 1px solid #30363d; }
        .logo { color: var(--main-green); font-size: 24px; font-weight: bold; text-decoration: none; }
        .auth-btn { background: var(--main-green); color: black; border: none; padding: 8px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .hero { padding: 60px 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; max-width: 1000px; margin: 20px auto; padding: 0 20px; }
        .card { background: var(--card-bg); padding: 30px; border-radius: 10px; border: 1px solid #30363d; cursor: pointer; transition: 0.3s; }
        .card:hover { border-color: var(--main-green); transform: translateY(-5px); }
        
        /* 登录弹窗样式 */
        .modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #21262d; padding: 30px; border-radius: 10px; border: 2px solid var(--main-green); z-index: 1000; width: 320px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .modal h3 { margin-top: 0; color: var(--main-green); }
        .modal input { width: 90%; padding: 12px; margin: 8px 0; border-radius: 5px; border: 1px solid #30363d; background: #0d1117; color: white; }
        .modal-btns { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 999; }
        .user-tag { color: var(--main-green); font-weight: bold; margin-right: 15px; }
    </style>
</head>
<body>

<nav>
    <a href="#" class="logo">生存法则</a>
    <div id="auth-ui">
        <button class="auth-btn" onclick="showModal()">登录 / 注册</button>
    </div>
</nav>

<div class="hero">
    <h1 id="welcome-msg">生存法则 · 官方社区</h1>
    <p style="color:var(--text-gray)">搜集物资、交易货品、探索未知地图</p>
</div>

<div class="grid">
    <div class="card" onclick="checkAuth('组队大厅')"><h3>组队大厅</h3><p>寻找队友并肩作战</p></div>
    <div class="card" onclick="checkAuth('交易行')"><h3>交易行</h3><p>安全的物资买卖中心</p></div>
    <div class="card" onclick="checkAuth('兑换码')"><h3>兑换码</h3><p>领取限时物资奖励</p></div>
</div>

<div class="overlay" id="overlay" onclick="hideModal()"></div>
<div class="modal" id="auth-modal">
    <h3 id="modal-title">加入社区</h3>
    <input type="text" id="reg-nickname" placeholder="游戏昵称">
    <input type="text" id="reg-id" placeholder="账号 ID (下次登录用)">
    <input type="password" id="reg-pw" placeholder="设置密码">
    <input type="password" id="reg-pw-confirm" placeholder="确认密码">
    <div class="modal-btns">
        <button class="auth-btn" onclick="handleRegister()">立即注册</button>
        <p style="font-size: 12px; color: var(--text-gray); cursor: pointer;" onclick="switchToLogin()">已有账号？去登录</p>
    </div>
</div>

<div class="modal" id="login-modal">
    <h3>欢迎回来</h3>
    <input type="text" id="login-id" placeholder="输入账号 ID">
    <input type="password" id="login-pw" placeholder="输入密码">
    <div class="modal-btns">
        <button class="auth-btn" onclick="handleLogin()">登录</button>
        <p style="font-size: 12px; color: var(--text-gray); cursor: pointer;" onclick="switchToRegister()">没账号？去注册</p>
    </div>
</div>

<script>
    let currentUser = JSON.parse(localStorage.getItem('survival_user'));

    // 页面加载检查登录状态
    window.onload = () => { updateUI(); };

    window.showModal = () => { switchToRegister(); document.getElementById('overlay').style.display = 'block'; };
    window.hideModal = () => { 
        document.getElementById('auth-modal').style.display = 'none'; 
        document.getElementById('login-modal').style.display = 'none';
        document.getElementById('overlay').style.display = 'none'; 
    };

    window.switchToLogin = () => {
        document.getElementById('auth-modal').style.display = 'none';
        document.getElementById('login-modal').style.display = 'block';
    };

    window.switchToRegister = () => {
        document.getElementById('login-modal').style.display = 'none';
        document.getElementById('auth-modal').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    };

    // 注册逻辑
    window.handleRegister = () => {
        const name = document.getElementById('reg-nickname').value;
        const id = document.getElementById('reg-id').value;
        const pw = document.getElementById('reg-pw').value;
        const pwc = document.getElementById('reg-pw-confirm').value;

        if(!name || !id || !pw) return alert("请填写完整信息！");
        if(pw !== pwc) return alert("两次密码输入不一致！");
        if(localStorage.getItem('user_' + id)) return alert("该 ID 已被注册！");

        const userData = { name, id, pw };
        localStorage.setItem('user_' + id, JSON.stringify(userData));
        localStorage.setItem('survival_user', JSON.stringify(userData));
        currentUser = userData;
        alert("注册成功！欢迎你，" + name);
        hideModal();
        updateUI();
    };

    // 登录逻辑
    window.handleLogin = () => {
        const id = document.getElementById('login-id').value;
        const pw = document.getElementById('login-pw').value;
        const savedData = localStorage.getItem('user_' + id);

        if(!savedData) return alert("账号不存在！");
        const user = JSON.parse(savedData);
        if(user.pw !== pw) return alert("密码错误！");

        localStorage.setItem('survival_user', JSON.stringify(user));
        currentUser = user;
        alert("登录成功！");
        hideModal();
        updateUI();
    };

    window.logout = () => {
        localStorage.removeItem('survival_user');
        currentUser = null;
        updateUI();
    };

    window.checkAuth = (target) => {
        if(!currentUser) return alert("请先登录账号！");
        alert("正在进入 " + target + "...");
    };

    function updateUI() {
        const ui = document.getElementById('auth-ui');
        const welcome = document.getElementById('welcome-msg');
        if (currentUser) {
            welcome.innerText = "欢迎回来, " + currentUser.name;
            ui.innerHTML = `<span class="user-tag">ID: ${currentUser.id}</span><button class="auth-btn" style="background:#e74c3c; color:white;" onclick="logout()">退出</button>`;
        } else {
            welcome.innerText = "生存法则 · 官方社区";
            ui.innerHTML = `<button class="auth-btn" onclick="showModal()">登录 / 注册</button>`;
        }
    }
</script>
</body>
</html>
