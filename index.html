<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿå­˜æ³•åˆ™ Â· SURVIVAL RULES</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+SC:wght@300;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --neon-alt: #2ecc71; --bg: #020508; --glass: rgba(10, 20, 30, 0.7); --border: rgba(0, 242, 255, 0.3); }
        body { 
            background: var(--bg); color: #fff; font-family: 'Noto Sans SC', sans-serif; margin: 0; 
            background-image: 
                linear-gradient(rgba(0, 242, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 242, 255, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
            overflow-x: hidden;
        }
        body::before {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 50%, transparent 0%, rgba(2, 5, 8, 0.8) 100%);
            pointer-events: none; z-index: 1;
        }
        nav { 
            background: rgba(5, 10, 15, 0.85); backdrop-filter: blur(15px); border-bottom: 2px solid var(--border);
            padding: 15px 40px; display: flex; justify-content: space-between; align-items: center; 
            position: sticky; top: 0; z-index: 1000; box-shadow: 0 0 20px rgba(0, 242, 255, 0.1);
        }
        .logo { font-family: 'Orbitron'; font-size: 24px; color: #fff; text-decoration: none; letter-spacing: 2px; }
        .logo span { color: var(--neon); text-shadow: 0 0 15px var(--neon); }
        .container { position: relative; z-index: 2; max-width: 1200px; margin: 0 auto; padding: 60px 20px; text-align: center; }
        h1 { font-family: 'Orbitron'; font-size: 55px; margin: 0; letter-spacing: 5px; text-shadow: 0 0 20px var(--neon); }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; margin-top: 50px; }
        .card { 
            background: var(--glass); border: 1px solid var(--border); border-radius: 12px; padding: 30px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: pointer; position: relative; overflow: hidden;
        }
        .card:hover { 
            border-color: var(--neon); transform: translateY(-10px) scale(1.02);
            box-shadow: 0 0 40px rgba(0, 242, 255, 0.2); background: rgba(0, 242, 255, 0.05);
        }
        .card::after {
            content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(45deg, transparent, rgba(0, 242, 255, 0.1), transparent);
            transform: rotate(45deg); transition: 0.5s;
        }
        .card:hover::after { left: 100%; }
        .card h3 { color: var(--neon); margin: 15px 0; font-family: 'Orbitron'; font-size: 20px; }
        .modal-content { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            background: rgba(5, 10, 15, 0.95); border: 2px solid var(--neon); box-shadow: 0 0 50px rgba(0, 242, 255, 0.3);
            border-radius: 5px; padding: 35px; width: 440px; color: #fff;
        }
        .btn { 
            background: transparent; color: var(--neon); border: 1px solid var(--neon); 
            padding: 12px; font-weight: bold; cursor: pointer; transition: 0.3s;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .btn:hover { background: var(--neon); color: #000; box-shadow: 0 0 20px var(--neon); }
        input { 
            width: 100%; padding: 12px; margin: 10px 0; background: rgba(0,0,0,0.5); 
            border: 1px solid #333; border-radius: 0; color: #00f2ff; font-family: 'Orbitron';
        }
    </style>
</head>
<body>
<nav>
    <a href="#" class="logo">SURVIVAL<span>RULES_v2.0</span></a>
    <div id="auth-ui"></div>
</nav>

<div class="container">
    <h1>ç”Ÿå­˜æ³•åˆ™</h1>
    <p style="color: var(--neon); opacity: 0.7; letter-spacing: 3px;">NEURAL_NETWORK_ACTIVE // å¹¸å­˜è€…åè®®å·²å¯åŠ¨</p>
    
    <div class="grid">
        <div class="card" onclick="openChat()"><h3>ğŸ“¡ ç»„é˜Ÿé¢‘é“</h3><p>å»ºç«‹åŠ å¯†æˆ˜æœ¯é“¾è·¯</p></div>
        <div class="card" onclick="toggle('wiki-modal')"><h3>ğŸ“‘ åè®®æ‰‹å†Œ</h3><p>æ ¸å¿ƒæŒ‡ä»¤ä¸ç‰¹æŠ€è§£æ</p></div>
        <div class="card" onclick="toggle('market-modal')"><h3>âš–ï¸ äº¤æ˜“ç»ˆç«¯</h3><p>å…¨çƒç‰©èµ„æµè½¬ä¸­æ¢ (å•ä½ï¼šå—)</p></div>
        <div class="card" onclick="toggle('staff-modal')"><h3>ğŸ‘¤ æ ¸å¿ƒèŠ‚ç‚¹</h3><p>ç³»ç»Ÿç®¡ç†å‘˜åå•</p></div>
        <div class="card" onclick="toggle('gift-modal')"><h3>ğŸ è¡¥ç»™å¯†ä»¤</h3><p>è¾“å…¥ä»£ç è·å– 10 é’»çŸ³</p></div>
        <div class="card" onclick="alert('ERROR: æƒé™ä¸è¶³')"><h3>ğŸª èµ„æºé™çº§</h3><p>å¿«é€Ÿå˜ç°åŠŸèƒ½å»ºè®¾ä¸­</p></div>
    </div>
</div>

<div id="gift-modal" class="modal"><div class="modal-content">
    <h2 style="color:var(--neon)">è¡¥ç»™éªŒè¯ç³»ç»Ÿ</h2>
    <p style="font-size:12px; color:rgba(255,255,255,0.5);">[ç³»ç»Ÿå¤‡æ³¨]ï¼šæ¸¸æˆåå­—å¿…é¡»å‡†ç¡®ï¼Œå•è´¦å·é™é¢†ä¸€æ¬¡</p>
    <input type="text" id="g-game-name" placeholder="IDENT_PLAYER_NAME (æ¸¸æˆå)">
    <input type="text" id="g-code" placeholder="ACCESS_CODE (å…‘æ¢ç )">
    <button class="btn" onclick="redeemCode()">æ‰§è¡Œå…‘æ¢åè®®</button>
    <button class="btn" style="border-color:#555; color:#888; margin-top:5px;" onclick="toggle('gift-modal')">å–æ¶ˆ</button>
</div></div>

<div id="wiki-modal" class="modal"><div class="modal-content" style="width: 500px; text-align: left;">
    <h2 style="color:var(--neon); text-align:center;">åè®®è¯¦æƒ…</h2>
    <p><b>å†›å›¢æ ¸å¿ƒæŒ‡ä»¤ï¼š</b><br>
    - !åˆ›å»ºå†›å›¢ [å] // æˆç«‹åŠ¿åŠ›<br>
    - !é‚€è¯· [å] // æ‰©å……èŠ‚ç‚¹<br>
    - !å›åŸºåœ° // ç©ºé—´è·³è·ƒè‡³æ®ç‚¹<br>
    - !è®¾ç½®åŸºåœ° // å®šä½å½“å‰åæ ‡</p>
    <p style="color: #ff5555; font-size: 11px;">* æ³¨æ„ï¼šæˆ˜æ–—å†²çªä¸­ï¼ˆå—ä¼¤10ç§’å†…ï¼‰æ— æ³•æ‰§è¡Œè·³è·ƒåè®®ã€‚</p>
    <p><b>ç‰¹æ®Šé“å…·ï¼š</b><br>
    - é»„é‡‘é¹¿è§’: æ¿€æ´» 5 ç§’è·³è·ƒå¢å¼ºä¸é€Ÿåº¦å€å¢ã€‚</p>
    <button class="btn" onclick="toggle('wiki-modal')">å…³é—­</button>
</div></div>

<div id="staff-modal" class="modal"><div class="modal-content">
    <h2 style="color:var(--neon)">æ ¸å¿ƒç®¡ç†å‘˜</h2>
    <p><b>IKUN5556</b> - è…ç«¹ (ROOT_ADMIN)</p>
    <p><b>Peter_YT_Bilibili</b> - å‰¯è…ç«¹ (SUB_ADMIN)</p>
    <p><b>CS||Steve</b> - æ ¸å¿ƒå¼€å‘ (DEV_NODE)</p>
    <button class="btn" onclick="toggle('staff-modal')">è¿”å›</button>
</div></div>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, query, orderBy, limit, onSnapshot, serverTimestamp, deleteDoc, doc, updateDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = { apiKey: "AIzaSyBC92jwiCLsfG6bE4k2Jo4KQSiI-A_gxII", authDomain: "bloxd-survival.firebaseapp.com", projectId: "bloxd-survival", storageBucket: "bloxd-survival.firebasestorage.app", messagingSenderId: "60666065786", appId: "1:60666065786:web:bdc3131accaceb0180dcc3" };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    let user = JSON.parse(localStorage.getItem('SURVIVAL_USER'));

    window.toggle = (id) => { const el = document.getElementById(id); el.style.display = (el.style.display === 'block') ? 'none' : 'block'; };
    
    // å…‘æ¢é€»è¾‘ï¼šè®°å½•æ¸¸æˆåå­—å¹¶é™é¢†ä¸€æ¬¡
    window.redeemCode = async () => {
        if(!user) return alert("è¯·å…ˆåŒæ­¥èº«ä»½ ID");
        const gameName = document.getElementById('g-game-name').value;
        const code = document.getElementById('g-code').value;
        
        const redeemKey = `CLAIMED_${user.id}_${code}`;
        if(localStorage.getItem(redeemKey)) return alert("æ­¤è´¦å·å·²é¢†å–è¿‡è¡¥ç»™ [ERROR_ALREADY_CLAIMED]");

        if(code === "SURVIVAL666") {
            await addDoc(collection(db, "logs"), { 
                type: "REDEEM", 
                userId: user.id, 
                targetName: gameName, 
                code: code, 
                timestamp: serverTimestamp() 
            });
            localStorage.setItem(redeemKey, "true");
            alert(`è¡¥ç»™ç”³è¯·å·²æäº¤ï¼\nç›®æ ‡ï¼š${gameName}\nå¥–åŠ±ï¼š10 é’»çŸ³`);
            toggle('gift-modal');
        } else {
            alert("å¯†ä»¤æ— æ•ˆ [INVALID_ACCESS_CODE]");
        }
    };

    // å…¶ä»–é€»è¾‘å®Œå…¨ä¿ç•™åŸæœ‰äº¤æ˜“è¡Œè¯„è®ºã€åŒæ­¥èº«ä»½åŠŸèƒ½...
    window.handleAuth = () => { /* ä¿æŒåŸæœ‰ä»£ç é€»è¾‘ */ };
    onSnapshot(collection(db, "market"), (sn) => { /* ä¿æŒåŸæœ‰å¸¦è¯„è®ºçš„äº¤æ˜“è¡Œæ¸²æŸ“é€»è¾‘ */ });
</script>
</body>
</html>
